#!/usr/bin/fish

set -q argv[1]; or set argv[1] $PWD

function process_album
    set files (fd -e flac -e mp3 -e m4a -t f -d 1 . $argv[1])
    if test (count $files) -gt 0
        echo "ðŸŽµ Processing album: $argv[1]"
        loudgain --album --noclip --tagmode=e $files
    end
end

process_album $argv[1]

set subdirs (fd -t d . $argv[1])
if test (count $subdirs) -gt 0
    for dir in $subdirs
        process_album $dir
    end
end

